<!-- Lesson 2 — Working with ImageCollections -->
<h2>Lesson 2bedtime — Working with ImageCollections</h2>

<p>In this lesson, you’ll start using real satellite imagery. You’ll work with a dataset from Landsat 8 that provides surface reflectance values. Google Earth Engine stores these images in something called an ImageCollection.</p>

<p>In this lesson, you’ll learn how to:</p>
<ul>
  <li>Load a dataset using <code>ee.ImageCollection()</code></li>
  <li>Filter it by date and cloud cover</li>
  <li>Turn it into one composite image using <code>.mosaic()</code></li>
  <li>Display it with <code>Map.addLayer()</code></li>
  <li>Clip it to a boundary</li>
</ul>

<h3>2.1 Loading the dataset</h3>
<p>To load satellite data, use <code>ee.ImageCollection()</code> and put the dataset name in quotes. For this lesson, we’re using:</p>
<code>'LANDSAT/LC08/C01/T1_SR'</code>

<p>This is the Surface Reflectance product for Landsat 8. The images have already been atmospherically corrected, so you don’t need to scale them.</p>

<p>Let's create a variable called "landsat" that stores our Landsat image collection.</p>
<code>var landsat = ee.ImageCollection("LANDSAT/LC08/C02/T1_L2");</code>

<p>Now you try it. Create a variable called "my_landsat_collection" and load the same Landsat dataset.</p>

<div style="display:flex; align-items:center; margin-bottom:12px;">
  <div id="hint21" style="visibility:hidden; background-color:#f0f0f0; border-left:4px solid #ccc; padding:6px 8px; margin-right:12px; flex-grow:1;">
    Use <code>ee.ImageCollection()</code> with the dataset ID in quotes. Assign it to a variable called <code>my_landsat_collection</code>.
  </div>
  <button id="hintButton21" onclick="
    var el = document.getElementById('hint21');
    var btn = document.getElementById('hintButton21');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; cursor:pointer; width:60px;">
    hint
  </button>
</div>

<div style="display:flex; align-items:center; margin-bottom:12px;">
  <div id="code21" style="visibility:hidden; background-color:#f0f0f0; border-left:4px solid #ccc; padding:6px 8px; margin-right:12px; flex-grow:1;">
    <code>var my_landsat_collection = ee.ImageCollection("LANDSAT/LC08/C02/T1_L2");</code>
  </div>
  <button id="codeButton21" onclick="
    var el = document.getElementById('code21');
    var btn = document.getElementById('codeButton21');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; cursor:pointer; width:60px;">
    code
  </button>
</div>

<p>Now try printing "my_landsat_collection". What happens?</p>
<code>print(my_landsat_collection);</code>

<h3>2.2 Filtering by date</h3>
<p>Try filtering your ImageCollection to include only May 2024, and store the result in a variable called <code>mayImages</code>.</p>

<div style="display:flex; align-items:center; margin-bottom:12px;">
  <div id="hint22" style="visibility:hidden; background-color:#f0f0f0; border-left:4px solid #ccc; padding:6px 8px; margin-right:12px; flex-grow:1;">
    Use <code>.filterDate()</code> with the correct date range and assign the result to a new variable called <code>mayImages</code>.
  </div>
  <button id="hintButton22" onclick="
    var el = document.getElementById('hint22');
    var btn = document.getElementById('hintButton22');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; cursor:pointer; width:60px;">
    hint
  </button>
</div>

<div style="display:flex; align-items:center; margin-bottom:12px;">
  <div id="code22" style="visibility:hidden; background-color:#f0f0f0; border-left:4px solid #ccc; padding:6px 8px; margin-right:12px; flex-grow:1;">
    <code>var mayImages = my_landsat_collection.filterDate('2024-05-01', '2024-06-01');</code>
  </div>
  <button id="codeButton22" onclick="
    var el = document.getElementById('code22');
    var btn = document.getElementById('codeButton22');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; cursor:pointer; width:60px;">
    code
  </button>
</div>

<h3>2.3 Filtering by cloud cover</h3>
<p>Now filter the images by cloud cover and store the result in <code>cleanImages</code>.</p>

<div style="display:flex; align-items:center; margin-bottom:12px;">
  <div id="hint23" style="visibility:hidden; background-color:#f0f0f0; border-left:4px solid #ccc; padding:6px 8px; margin-right:12px; flex-grow:1;">
    Use <code>.filter()</code> and <code>ee.Filter.lt()</code> on <code>mayImages</code> to check for cloud cover less than 5.
  </div>
  <button id="hintButton23" onclick="
    var el = document.getElementById('hint23');
    var btn = document.getElementById('hintButton23');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; cursor:pointer; width:60px;">
    hint
  </button>
</div>

<div style="display:flex; align-items:center; margin-bottom:12px;">
  <div id="code23" style="visibility:hidden; background-color:#f0f0f0; border-left:4px solid #ccc; padding:6px 8px; margin-right:12px; flex-grow:1;">
    <code>var cleanImages = mayImages.filter(ee.Filter.lt('CLOUD_COVER', 5));</code>
  </div>
  <button id="codeButton23" onclick="
    var el = document.getElementById('code23');
    var btn = document.getElementById('codeButton23');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; cursor:pointer; width:60px;">
    code
  </button>
</div>

<h3>2.4 Mosaicking images together</h3>
<p>Create a composite mosaic of <code>cleanImages</code> and store it as <code>myMosaic</code>.</p>

<div style="display:flex; align-items:center; margin-bottom:12px;">
  <div id="code24" style="visibility:hidden; background-color:#f0f0f0; border-left:4px solid #ccc; padding:6px 8px; margin-right:12px; flex-grow:1;">
    <code>var myMosaic = cleanImages.mosaic();</code>
  </div>
  <button id="codeButton24" onclick="
    var el = document.getElementById('code24');
    var btn = document.getElementById('codeButton24');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; cursor:pointer; width:60px;">
    code
  </button>
</div>

<h3>2.5 Adding the image to the map</h3>
<p>Add <code>myMosaic</code> to the map with a custom label and visibility flag set to <code>false</code>.</p>

<div style="display:flex; align-items:center; margin-bottom:12px;">
  <div id="code25" style="visibility:hidden; background-color:#f0f0f0; border-left:4px solid #ccc; padding:6px 8px; margin-right:12px; flex-grow:1;">
    <code>Map.addLayer(myMosaic, visualization, 'May Mosaic', false);</code>
  </div>
  <button id="codeButton25" onclick="
    var el = document.getElementById('code25');
    var btn = document.getElementById('codeButton25');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; cursor:pointer; width:60px;">
    code
  </button>
</div>

<h3>2.6 Printing the mosaic</h3>
<p>Use <code>print()</code> to inspect your mosaic image in the console. This can help you confirm that your filtering and mosaicking worked as expected.</p>
<code>print("Landsat mosaic:", myMosaic);</code>

<h3>2.7 Clipping the mosaic to a boundary</h3>
<p>Sometimes we only want to view or analyze part of an image — for example, just one state. In Earth Engine, you can clip an image to a shape using the <code>.clip()</code> function. To do that, you first need to create a geometry object.</p>

<p>We’ll define a rectangle that includes most of Missouri and centers on St. Louis. We’ll also center the map on that rectangle at a zoom level that still shows the surrounding states.</p>

<div style="display:flex; align-items:center; margin-bottom:12px;">
  <div id="hint26" style="visibility:hidden; background-color:#f0f0f0; border-left:4px solid #ccc; padding:6px 8px; margin-right:12px; flex-grow:1;">
    Use <code>ee.Geometry.Rectangle()</code> to create a box: <code>[west, south, east, north]</code>. Reverse latitude/longitude from Google Maps coordinates.
  </div>
  <button id="hintButton26" onclick="
    var el = document.getElementById('hint26');
    var btn = document.getElementById('hintButton26');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; cursor:pointer; width:60px;">
    hint
  </button>
</div>

<div style="display:flex; align-items:center; margin-bottom:12px;">
  <div id="code26" style="visibility:hidden; background-color:#f0f0f0; border-left:4px solid #ccc; padding:6px 8px; margin-right:12px; flex-grow:1;">
    <code>var missouriBox = ee.Geometry.Rectangle([-93.5123, 36.2114, -89.1032, 40.3299]);<br>var clippedMosaic = myMosaic.clip(missouriBox);<br>Map.addLayer(clippedMosaic, visualization, 'Clipped May Mosaic');<br>Map.centerObject(missouriBox, 6);</code>
  </div>
  <button id="codeButton26" onclick="
    var el = document.getElementById('code26');
    var btn = document.getElementById('codeButton26');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; cursor:pointer; width:60px;">
    code
  </button>
</div>
