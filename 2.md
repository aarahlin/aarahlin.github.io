<!-- Lesson 2 HTML - Using Landsat 8 SR dataset -->
<h2>Lesson 2 — Working with ImageCollections and FeatureCollections</h2>

<p>In this lesson, you’ll start using real satellite imagery. You’ll work with a dataset from Landsat 8 that provides surface reflectance values. 
  Google Earth Engine stores these images in something called an ImageCollection.</p>

<p>In this lesson, you’ll learn how to:</p>
<ul>
  <li>Load a dataset using <code>ee.ImageCollection()</code></li>
  <li>Filter it by date and cloud cover</li>
  <li>Turn it into one image using <code>.mosaic()</code></li>
  <li>Display it with <code>Map.addLayer()</code></li>
  <li>Clip it to a boundary</li>
</ul>

<h3>2.1 Loading the dataset</h3>
<p>To load satellite data, use <code>ee.ImageCollection()</code> and put the dataset name in quotes. For this lesson, we’re using:</p>
<code>'LANDSAT/LC08/C01/T1_SR'</code>

<p>This is the Surface Reflectance product for Landsat 8. The images have already been atmospherically corrected, so you don’t need to scale them.</p>

<p>Let's create a variable called "landsat" that stores our Landsat image collection. </p>
<code>var landsat = ee.ImageCollection('LANDSAT/LC08/C01/T1_SR');</code>

<p>Now you try it. Create a variable called "my_landsat_collection" and load the same Landsat dataset.</p>
<!-- HINT Row -->
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
  <div id="hint21" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1;">
Use <code>ee.ImageCollection()</code> with the dataset ID in quotes. Assign it to a variable called <code>my_landsat_collection</code>.
  </div>
  <button id="hintButton21" onclick="
    var el = document.getElementById('hint21');
    var btn = document.getElementById('hintButton21');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    hint
  </button>
</div>
<!-- CODE Row -->
<div style="display:flex; justify-content:space-between; align-items:center;">
  <div id="code21" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1;">
    <code>var my_landsat_collection = ee.ImageCollection('LANDSAT/LC08/C01/T1_SR');</code>
  </div>
  <button id="codeButton21" onclick="
    var el = document.getElementById('code21');
    var btn = document.getElementById('codeButton21');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    code
  </button>
</div>

<h3>2.2 Filtering by date</h3>
<p>Once you have an ImageCollection, it probably contains a lot of images from different times. You can filter it using the function <code>.filterDate()</code>.</p>

<p>Dates have to be written as YYYY-MM-DD in Google Earth Engine, and are INCLUSIVE of the starting date, but DO NOT INCLUDE the ending date. Just another quirk of GEE to keep in mind. </p>
<code>my_landsat_collection.filterDate('2020-07-01', '2020-08-31');</code>

<p>Now try filtering my_landsat_collection to include only May 2024. Store the result in a variable called <code>mayImages</code>.</p>
<!-- HINT Row -->
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
  <div id="hint22" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1;">
Use <code>.filterDate()</code> with the correct date range and assign the result to a new variable called <code>mayImages</code>.
  </div>
  <button id="hintButton22" onclick="
    var el = document.getElementById('hint22');
    var btn = document.getElementById('hintButton22');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    hint
  </button>
</div>
<!-- CODE Row -->
<div style="display:flex; justify-content:space-between; align-items:center;">
  <div id="code22" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1;">
    <code>var mayImages = my_landsat_collection.filterDate('2024-05-01', '2024-06-01');</code>
  </div>
  <button id="codeButton22" onclick="
    var el = document.getElementById('code22');
    var btn = document.getElementById('codeButton22');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    code
  </button>
</div>

<h3>2.3 Filtering by cloud cover</h3>

<p>Look at the documentation of the Landset data collection to examine the bands in the dataset. Notice that CLOUD_COVER is the name of one of the bands. To avoid cloudy images, we can use metadata that comes with each image. The <code>'CLOUD_COVER'</code> property tells you what percent of the image is cloudy. Use <code>ee.Filter.lt()</code> to keep only images where cloud cover is less than a threshold. </p>
<code>mayImages.filter(ee.Filter.lt('CLOUD_COVER', 10));</code>

<p>Your turn: Filter <code>mayImages</code> to keep only images with less than 5% cloud cover. Store the result in <code>cleanImages</code>.</p>
<!-- HINT Row -->
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
  <div id="hint23" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1;">
Use <code>.filter()</code> and <code>ee.Filter.lt()</code> on <code>mayImages</code> to check for cloud cover less than 5.
  </div>
  <button id="hintButton23" onclick="
    var el = document.getElementById('hint23');
    var btn = document.getElementById('hintButton23');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    hint
  </button>
</div>
<!-- CODE Row -->
<div style="display:flex; justify-content:space-between; align-items:center;">
  <div id="code23" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1;">
    <code>var cleanImages = mayImages.filter(ee.Filter.lt('CLOUD_COVER', 5));</code>
  </div>
  <button id="codeButton23" onclick="
    var el = document.getElementById('code23');
    var btn = document.getElementById('codeButton23');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    code
  </button>
</div>

<h3>2.4 Mosaicking images together</h3>
<p>If your ImageCollection has overlapping scenes, you can combine them into one image using <code>.mosaic()</code>. This makes it easier to display and analyze.</p>

<p>Example:</p>
<code>var image = cleanImages.mosaic();</code>

<p><strong>Your turn: Mosaic your filtered image collection. Call it <code>myMosaic</code>.</p>
<!-- HINT Row -->
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
  <div id="hint24" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1;">
Use <code>.mosaic()</code> on your cloud-filtered image collection and store it in a new variable.
  </div>
  <button id="hintButton24" onclick="
    var el = document.getElementById('hint24');
    var btn = document.getElementById('hintButton24');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    hint
  </button>
</div>
<!-- CODE Row -->
<div style="display:flex; justify-content:space-between; align-items:center;">
  <div id="code24" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1;">
    <code>var myMosaic = cleanImages.mosaic();</code>
  </div>
  <button id="codeButton24" onclick="
    var el = document.getElementById('code24');
    var btn = document.getElementById('codeButton24');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    code
  </button>
</div>


<h3>2.5 Adding layers to the map</h3>
<p>You can display an image using <code>Map.addLayer()</code>. If you pass <code>false</code> as the fourth argument, the layer will load in the map layers pane, but won’t be visible until you check it.</p>
<code>Map.addLayer(landsat, visualization, 'Landsat', false);</code>

<h3>2.6 Printing a mosaic</h3>
<p>When you call <code>.mosaic()</code> on an ImageCollection, it creates a single composite image. You can print it to the console to inspect its metadata.</p>
<code>landsat = landsat.mosaic();<br>print("Landsat mosaic:", landsat);</code>

<h3>2.7 Loading other imagery — NAIP example</h3>
<p>Let’s try loading a new dataset from the Earth Engine search bar: NAIP (National Agriculture Imagery Program). These are aerial images commonly used for crop monitoring. We’ll use the red, green, and blue bands.</p>
<code>
var NAIP = ee.ImageCollection('USDA/NAIP/DOQQ')
              .filter(ee.Filter.date('2017-01-01', '2018-12-31'));
var NAIPtrueColor = NAIP.select(['R', 'G', 'B']);
var trueColorVis = {
  min: 0,
  max: 255,
};
Map.addLayer(NAIPtrueColor, trueColorVis, 'NAIP', false);
NAIPtrueColor = NAIPtrueColor.mosaic();
</code>

<h3>2.8 Working with feature collections</h3>
<p>Feature collections are vector datasets (like shapefiles). Each “feature” has a shape and some associated properties. This example loads administrative boundaries from FAO GAUL 2015.</p>
<code>
var bounds = ee.FeatureCollection('FAO/GAUL/2015/level1');
Map.addLayer(bounds, {}, 'First Level Administrative Units', false);
print('Administrative boundaries dataset:', bounds);
</code>

<h3>2.9 Filtering features by property</h3>
<p>You can filter a feature collection by one of its properties. In this case, we filter by <code>ADM1_CODE</code> to get Illinois.</p>
<code>var ILbounds = bounds.filter(ee.Filter.eq('ADM1_CODE', 3227));</code>

<h3>2.10 Clipping imagery to a feature</h3>
<p>You can clip either an Image or an ImageCollection to a boundary. This limits what is shown to only the selected region.</p>
<code>
var landsatIL = landsat.clip(ILbounds);
Map.addLayer(landsatIL, visualization, 'Landsat Illinois');

var NAIP_IL = NAIPtrueColor.clip(ILbounds);
Map.addLayer(NAIP_IL, trueColorVis, 'NAIP Illinois');
</code>



<meta http-equiv='cache-control' content='no-cache'> 
<meta http-equiv='expires' content='0'> 
<meta http-equiv='pragma' content='no-cache'>
