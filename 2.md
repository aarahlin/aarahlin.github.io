<!-- Lesson 2 HTML - Using Landsat 8 SR dataset -->
<h2>Lesson 2 — Working with ImageCollections</h2>

<p>In this lesson, you’ll start using real satellite imagery. You’ll work with a dataset from Landsat 8 that provides surface reflectance values. 
  Google Earth Engine stores these images in something called an ImageCollection.</p>

<p>In this lesson, you’ll learn how to:</p>
<ul>
  <li>Load a dataset using <code>ee.ImageCollection()</code></li>
  <li>Filter it by date and cloud cover</li>
  <li>Turn it into one composite image using <code>.mosaic()</code></li>
  <li>Display it with <code>Map.addLayer()</code></li>
  <li>Clip it to a boundary</li>
</ul>

<h3>2.1 Loading the dataset</h3>
<p>To load satellite data, use <code>ee.ImageCollection()</code> and put the dataset name in quotes. For this lesson, we’re using:</p>
<code>'LANDSAT/LC08/C01/T1_SR'</code>

<p>This is the Surface Reflectance product for Landsat 8. The images have already been atmospherically corrected, so you don’t need to scale them.</p>

<p>Let's create a variable called "landsat" that stores our Landsat image collection. </p>
<code>var landsat = ee.ImageCollection("LANDSAT/LC08/C02/T1_L2");</code>

<p>Now you try it. Create a variable called "my_landsat_collection" and load the same Landsat dataset.</p>
<!-- HINT Row -->
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
  <div id="hint21" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
Use <code>ee.ImageCollection()</code> with the dataset ID in quotes. Assign it to a variable called <code>my_landsat_collection</code>.
  </div>
  <button id="hintButton21" onclick="
    var el = document.getElementById('hint21');
    var btn = document.getElementById('hintButton21');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    hint
  </button>
</div>
<!-- CODE Row -->
<div style="display:flex; justify-content:space-between; align-items:center;">
  <div id="code21" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
    <code>var var my_landsat_collection = ee.ImageCollection("LANDSAT/LC08/C02/T1_L2");</code>
  </div>
  <button id="codeButton21" onclick="
    var el = document.getElementById('code21');
    var btn = document.getElementById('codeButton21');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    code
  </button>
</div>

<p>Now try printing "my_landset_collection". What happens? </p>
<code>print(my_landset_collection);</code>

<p> Printing the entire image collection doesn't work. Can you guess why? What does the error message tell you? </p>

<h3>2.2 Filtering by date</h3>
<p>Once you have an ImageCollection, it probably contains a lot of images from different times. You can filter it using the function <code>.filterDate()</code>.</p>

<p>Dates have to be written as YYYY-MM-DD in Google Earth Engine, and are **inclusive** of the starting date, but **do not include** the ending date. Just another quirk of Google Earth Engine to keep in mind when you're analyzing satellite data. </p>
<code>my_landsat_collection.filterDate('2020-07-01', '2020-08-31');</code>

<p>Now try filtering my_landsat_collection to include only May 2024. Store the result in a variable called <code>mayImages</code>.</p>
<!-- HINT Row -->
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
  <div id="hint22" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
Use <code>.filterDate()</code> with the correct date range and assign the result to a new variable called <code>mayImages</code>.
  </div>
  <button id="hintButton22" onclick="
    var el = document.getElementById('hint22');
    var btn = document.getElementById('hintButton22');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    hint
  </button>
</div>
<!-- CODE Row -->
<div style="display:flex; justify-content:space-between; align-items:center;">
  <div id="code22" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
    <code>var mayImages = my_landsat_collection.filterDate('2024-05-01', '2024-06-01');</code>
  </div>
  <button id="codeButton22" onclick="
    var el = document.getElementById('code22');
    var btn = document.getElementById('codeButton22');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    code
  </button>
</div>

<h3>2.3 Filtering by cloud cover</h3>

<p>Look at the documentation of the Landset data collection to examine the bands in the dataset. Notice that CLOUD_COVER is the name of one of the bands. To avoid cloudy images, we can use metadata that comes with each image. The <code>'CLOUD_COVER'</code> property tells you what percent of the image is cloudy. Use <code>ee.Filter.lt()</code> to keep only images where cloud cover is less than a threshold. </p>
<code>mayImages.filter(ee.Filter.lt('CLOUD_COVER', 10));</code>

<p>Your turn: Filter <code>mayImages</code> to keep only images with less than 5% cloud cover. Store the result in <code>cleanImages</code>.</p>
<!-- HINT Row -->
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
  <div id="hint23" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
Use <code>.filter()</code> and <code>ee.Filter.lt()</code> on <code>mayImages</code> to check for cloud cover less than 5.
  </div>
  <button id="hintButton23" onclick="
    var el = document.getElementById('hint23');
    var btn = document.getElementById('hintButton23');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    hint
  </button>
</div>
<!-- CODE Row -->
<div style="display:flex; justify-content:space-between; align-items:center;">
  <div id="code23" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
    <code>var cleanImages = mayImages.filter(ee.Filter.lt('CLOUD_COVER', 5));</code>
  </div>
  <button id="codeButton23" onclick="
    var el = document.getElementById('code23');
    var btn = document.getElementById('codeButton23');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    code
  </button>
</div>

<h3>2.4 Mosaicking images together</h3>
<p>If your ImageCollection has overlapping scenes, you can combine them into one image using <code>.mosaic()</code>. This makes it easier to display and analyze.</p>

<p>Example:</p>
<code>var image = cleanImages.mosaic();</code>

<p>Your turn: Mosaic <code>cleanImages</code> — the variable you created — using <code>.mosaic()</code>. Store the result in a new variable called <code>myMosaic</code>.</p>
<!-- HINT Row -->
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
  <div id="hint24" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
Use <code>.mosaic()</code> on your cloud-filtered image collection and store it in a new variable.
  </div>
  <button id="hintButton24" onclick="
    var el = document.getElementById('hint24');
    var btn = document.getElementById('hintButton24');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    hint
  </button>
</div>
<!-- CODE Row -->
<div style="display:flex; justify-content:space-between; align-items:center;">
  <div id="code24" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
    <code>var myMosaic = cleanImages.mosaic();</code>
  </div>
  <button id="codeButton24" onclick="
    var el = document.getElementById('code24');
    var btn = document.getElementById('codeButton24');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    code
  </button>
</div>



<h3>2.5 Adding the image to the map</h3>
<p>You can add an image to the map in the Google Earth Engine console using <code>Map.addLayer()</code>. The fourth argument determines whether 
  it shows up immediately. If set to <code>false</code>, the layer is added to the Layers panel but not turned on by default. 
  This can be helpful when working with a global dataset that takes time to render.</p>
<code>Map.addLayer(landsat, visualization, 'Landsat', false);</code>

<p>Your turn: Add <code>myMosaic</code> to the map using <code>Map.addLayer()</code>, and turn it off by default. Label it "May Mosaic".</p>
<!-- HINT Row -->
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
  <div id="hint25" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
Use <code>Map.addLayer()</code> with <code>myMosaic</code>, your visualization object, and label the layer <code>"May Mosaic"</code>. Set the fourth argument to <code>false</code>.
  </div>
  <button id="hintButton25" onclick="
    var el = document.getElementById('hint25');
    var btn = document.getElementById('hintButton25');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    hint
  </button>
</div>
<!-- CODE Row -->
<div style="display:flex; justify-content:space-between; align-items:center;">
  <div id="code25" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
    <code>Map.addLayer(myMosaic, visualization, 'May Mosaic', false);</code>
  </div>
  <button id="codeButton25" onclick="
    var el = document.getElementById('code25');
    var btn = document.getElementById('codeButton25');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    code
  </button>
</div>
<code>Map.addLayer(landsat, visualization, 'Landsat', false);</code>

<h3>2.6 Printing the mosaic</h3>
<p>Use <code>print()</code> to inspect your mosaic image in the console. This can help you confirm that your filtering and mosaicking worked as expected.</p>
<code>print("Landsat mosaic:", myMosaic);</code>

<h3>2.7 Clipping the mosaic to a boundary</h3>
<p>Sometimes we only want to view or analyze part of an image — for example, just one state. In Earth Engine, you can clip an image to a shape using the <code>.clip()</code> function. To do that, you first need to create a geometry object. In this case, we'll create a rectangle using <code>ee.Geometry.Rectangle()</code>.</p>

<p>Here’s what each part does:</p>
<ul>
  <li><code>ee.Geometry.Rectangle()</code> creates a rectangular area using a list of four coordinates: [west, south, east, north]</li>
  <li><code>.clip()</code> crops the image to that shape</li>
  <li><code>Map.addLayer()</code> displays the new clipped image on the map</li>
  <li><code>Map.centerObject()</code> zooms and centers the view on your geometry</li>
</ul>

<p>We’ll define a rectangle that includes most of Missouri and centers on St. Louis. We’ll also center the map on that rectangle at a zoom level 
  that still shows the surrounding states.</p>

<p>Try writing your own <code>ee.Geometry.Rectangle()</code> that covers eastern Missouri. Think about what coordinates would put St. Louis near the center. Once you define it, clip <code>myMosaic</code> and map the result. Then use <code>Map.centerObject()</code> to zoom out enough to see surrounding states, not just Missouri.</p>
</code>

<p>Try it: define your own rectangle geometry using <code>ee.Geometry.Rectangle()</code> and clip your mosaic image using <code>.clip()</code>. Then display it using <code>Map.addLayer()</code>. After that, center the map on your rectangle using <code>Map.centerObject()</code> — use a zoom level of 6 to see Missouri and the surrounding states.</p>
<!-- HINT Row -->
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
  <div id="hint26" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
To make a box around St. Louis, you'll need to provide two corners in the format <code>[west, south, east, north]</code>. A good starting point is a lower-left corner around <code>[-93.0, 36.0]</code>, where -93.0 is the longitude (west) and 36.0 is the latitude (south).You can use Google Maps to find coordinates: right-click anywhere on the map and select "What's here?". The coordinates will appear at the bottom. These are usually listed as (latitude, longitude), so be sure to reverse them when entering values in Earth Engine. Coordinates from Google Maps often include multiple decimal places (e.g., -89.6016, 38.6271). You can use those to define a precise bounding box; Google Earth Engine will accept whatever level of precision for the coordinates that you provide.
</div>
  <button id="hintButton26" onclick="
    var el = document.getElementById('hint26');
    var btn = document.getElementById('hintButton26');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#689f38' : '#558b2f';
  " style="background-color:#689f38; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    hint
  </button>
</div>
<!-- CODE Row -->
<div style="display:flex; justify-content:space-between; align-items:center;">
  <div id="code26" style="visibility:hidden; height:auto; background-color:#f0f0f0; border-left:4px solid #ccc; padding:2px 6px; margin:0px; flex:1; border-left:4px solid #ccc; padding:2px 6px; margin:0px;">
    var missouriBox = ee.Geometry.Rectangle([-93.5123, 36.2114, -89.1032, 40.3299]);<br>var clippedMosaic = myMosaic.clip(missouriBox);<br>Map.addLayer(clippedMosaic, visualization, 'Clipped May Mosaic');<br>Map.centerObject(missouriBox, 6);</code>
  </div>
  <button id="codeButton26" onclick="
    var el = document.getElementById('code26');
    var btn = document.getElementById('codeButton26');
    var showing = el.style.visibility === 'visible';
    el.style.visibility = showing ? 'hidden' : 'visible';
    btn.style.backgroundColor = showing ? '#1e88e5' : '#1565c0';
  " style="background-color:#1e88e5; color:white; border:none; padding:4px 10px; border-radius:6px; font-weight:bold; cursor:pointer; margin-left:8px; width:60px;">
    code
  </button>
</div>

<meta http-equiv='cache-control' content='no-cache'> 
<meta http-equiv='expires' content='0'> 
<meta http-equiv='pragma' content='no-cache'>
